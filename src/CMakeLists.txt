ADD_EXECUTABLE(
    janus
    packet_queue
    janus
    main
)

SET( PACKAGELIST PCAP EVENT )

FOREACH( PACKAGE ${PACKAGELIST} )

    FIND_PACKAGE( ${PACKAGE} REQUIRED )
    MESSAGE( "${PACKAGE}: FOUND" )
    SET( HAVE_LIB${PACKAGE} 1 )
    INCLUDE_DIRECTORIES( ${${PACKAGE}_INCLUDE_DIRS} )
    TARGET_LINK_LIBRARIES( janus ${${PACKAGE}_LIBRARY} )
    MESSAGE( STATUS "${PACKAGE} includes: ${${PACKAGE}_INCLUDE_DIRS}" )
    MESSAGE( STATUS "${PACKAGE} libs: ${${PACKAGE}_LIBRARIES}" )

ENDFOREACH()

SET( CMAKE_C_FLAGS "-O3 -Wall -pedantic ${CMAKE_C_FLAGS}" )

IF("${CMAKE_SYSTEM_NAME}" MATCHES "Linux")
    SET(LINUX 1)
ENDIF("${CMAKE_SYSTEM_NAME}" MATCHES "Linux")

IF("${CMAKE_SYSTEM_NAME}" MATCHES "FreeBSD")
    SET(FREEBSD 1)
ENDIF("${CMAKE_SYSTEM_NAME}" MATCHES "FreeBSD")

CONFIGURE_FILE(config.h.in config.h)

INSTALL(
    TARGETS janus
    RUNTIME DESTINATION /usr/local/sbin
)
